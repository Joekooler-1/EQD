import pandas as pd

def load_and_tag(file_path, tag, remove_header=False):
    # Load data with or without header depending on the `remove_header` flag
    if remove_header:
        df = pd.read_excel(file_path, skiprows=1)  # Skip the first row if header is to be removed
    else:
        df = pd.read_excel(file_path)
    
    # Add a new column for the location tag
    df['Location'] = tag
    return df

def merge_files(toronto_path, sydney_path, london_path):
    # Load each file and tag with location; removing header for specific files if needed
    toronto_df = load_and_tag(toronto_path, 'TORONTO', remove_header=False)  # Header kept for Toronto
    sydney_df = load_and_tag(sydney_path, 'SYDNEY', remove_header=True)       # Remove header for Sydney
    london_df = load_and_tag(london_path, 'LONDON', remove_header=True)       # Remove header for London
    
    # Concatenate all dataframes
    merged_df = pd.concat([toronto_df, sydney_df, london_df], ignore_index=True)
    
    return merged_df

# Example file paths (replace with actual paths)
toronto_path = 'path/to/toronto.xls'
sydney_path = 'path/to/sydney.xls'
london_path = 'path/to/london.xls'

# Merge files
merged_data = merge_files(toronto_path, sydney_path, london_path)

# Save to a new Excel file or display the result
merged_data.to_excel('merged_output.xls', index=False)  # Save merged data
# print(merged_data)  # Uncomment to print merged data
